<div class="page-header">
  <h1>Регистрация</h1>
</div>

<loading-indicator></loading-indicator>

<div class="alert alert-danger" role="alert" *ngIf="errorMessage">{{errorMessage}}</div>

<div class="row">
  <div class="col-sm-6" [hidden]="submitted">
    <form (ngSubmit)="onSubmit(signupForm.value)" [ngFormModel]="signupForm">

      <div class="form-group">
        <label for="name">Логин</label>
        <input type="text" class="form-control" required ngControl="name" #name="ngForm" id="name">

        <div *ngIf="name.control.hasError('required') && name.control.touched" class="alert alert-danger">
          name is required
        </div>
        <div *ngIf="name.control.hasError('minlength') && name.control.touched" class="alert alert-danger">
          name is too short
        </div>
        <div *ngIf="name.control.hasError('maxlength') && name.control.touched" class="alert alert-danger">
          name is too long
        </div>
      </div>
      <p [hidden]="!result.err_name" class="alert alert-danger">{{(result.err_name)}}</p>

      <div class="form-group">
        <label for="password">Пароль</label>
        <input type="text" class="form-control" required ngControl="password" #password="ngForm" id="password">
        <div [hidden]="password.valid || password.pristine" class="alert alert-danger">
          Password is required
        </div>
      </div>

      <div class="form-group">
        <label for="password_repeat">Ещё раз пароль</label>
        <input type="text" class="form-control" required ngControl="password_repeat" #password_repeat="ngForm" id="password_repeat">

        <div *ngIf="password.control.hasError('required') && password.control.touched" class="alert alert-danger">
          Password is required
        </div>
      </div>
      <p [hidden]="!result.err_password" class="alert alert-danger">{{(result.err_password)}}</p>

      <div class="form-group">
        <label for="email">Email</label>
        <input type="text" class="form-control" required ngControl="email" #email="ngForm" id="email">

        <div *ngIf="email.control.hasError('required') && email.control.touched" class="alert alert-danger">
          email is required
        </div>
      </div>
      <p [hidden]="!result.err_email" class="alert alert-danger">{{(result.err_email)}}</p>

      <button type="submit" class="btn btn-primary" [disabled]="!signupForm.valid">Зарегистрироваться</button>
    </form>
  </div>
</div>

<div [hidden]="!submitted">
  <h2>Успешная регистрация</h2>
  <p class="alert alert-success">{{(result.message)}}</p>
</div>
